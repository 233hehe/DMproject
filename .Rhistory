rules2<-apriori(asloan2[,-9],parameter = list(supp=0.1,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules2<-apriori(asloan2[,-8],parameter = list(supp=0.1,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules2<-sort(rules,by="confidence",decreasing = TRUE)
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph")
inspect(rules2[1:5])
summary(rules2)
plot(rules[1:5], method="graph")
rules2<-apriori(asloan1,parameter = list(supp=0.1,conf=0.8,maxlen=3),
appearance = list(rhs=c('PROFITABLE.1=1'),default='lhs'),
control = list(verbose=F))
rules2<-sort(rules,by="confidence",decreasing = TRUE)
rules2<-apriori(asloan1,parameter = list(supp=0.1,conf=0.8,maxlen=3),
appearance = list(rhs=c('PROFITABLE.1=1'),default='lhs'),
control = list(verbose=F))
rules2<-sort(rules,by="confidence",decreasing = TRUE)
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph")
inspect(rules2[1:5])
summary(rules2)
plot(rules[1:5], method="graph")
subset.matrix <- is.subset(rules, rules)
subset.matrix[lower.tri(subset.matrix, diag=T)] <- NA
redundant <- colSums(subset.matrix, na.rm=T) >= 1
rules.pruned <- rules[!redundant]
rules<-rules.pruned
inspect(rules[1:5])
rules<-apriori(asloan[,-8],parameter = list(supp=0.01,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules<-sort(rules,by="confidence",decreasing = TRUE)
rules2<-apriori(asloan1,parameter = list(supp=0.1,conf=0.8,maxlen=3),
appearance = list(rhs=c('PROFITABLE.1=1'),default='lhs'),
control = list(verbose=F))
rules2<-sort(rules,by="confidence",decreasing = TRUE)
inspect(rules.pruned[1:5])
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph",interactive=TRUE,shading=NA)
#
inspect(rules2[1:5])
summary(rules2)
plot(rules[1:5], method="graph")
plot(rules[1:5], method="graph",interactive=TRUE,shading=NA)
plot(rules[1:5], method="graph",interactive=TRUE,shading=NA)
plot(rules[1:5], method="graph",shading=NA)
asloan2<-loan
asloan2<-loan
asloan2$AGE=NULL
asloan2$AMOUNT_REQUESTED=NULL
asloan2$NPV=NULL
asloan2<-data.frame(lapply(asloan2,factor))
rules2<-apriori(asloan2,parameter = list(supp=0.1,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules2<-sort(rules,by="confidence",decreasing = TRUE)
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph")
#
inspect(rules2[1:5])
summary(rules2)
plot(rules[1:5], method="graph")
rules2<-sort(rules,by=c("confidence","lift"),decreasing = TRUE)
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph")
#
inspect(rules2[1:5])
summary(rules2)
plot(rules[1:5], method="graph")
rules<-apriori(asloan[,-8],parameter = list(supp=0.001,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph")
sum(subset(loan$NPV,loan$SAV_ACCT==3))
sum(npv)
rules<-apriori(asloan[,-8],parameter = list(supp=0.03,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph")
rules<-apriori(asloan[,-8],parameter = list(supp=0.001,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules<-sort(rules,by="confidence",decreasing = TRUE)
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph")
sum(subset(loan$NPV,loan$SAV_ACCT==3&loan$JOB==0))
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(ggplot2)
library(cluster)
library(fpc)
library(arules)
library(arulesViz)
#
loan<-read.csv("../HW6/data.csv",stringsAsFactors=FALSE)
loan$OBS.<-NULL
loan$CREDIT_EXTENDED<-NULL
loan$AMOUNT_REQUESTED<-gsub(pattern = ",",replacement = "",x = loan$AMOUNT_REQUESTED)
loan$NPV<-gsub(pattern = ",",replacement = "",x = loan$NPV)
loan$NPV<-as.numeric(loan$NPV)
loan$AMOUNT_REQUESTED<-as.numeric(loan$AMOUNT_REQUESTED)
#
loan$CHK_ACCT<-as.factor(loan$CHK_ACCT)
loan$SAV_ACCT<-as.factor(loan$SAV_ACCT)
loan$HISTORY<-as.factor(loan$HISTORY)
loan$JOB<-as.factor(loan$JOB)
loan$TYPE<-as.factor(loan$TYPE)
set.seed(12345)
#
kmloan<-loan
#
loan$PROFITABLE<-as.factor(ifelse(loan$NPV>0,1,0))
dummies<-dummyVars(NPV~.,data=kmloan)
kmloan<-data.frame(predict(dummies,newdata = kmloan))
kmloan=data.frame(scale(kmloan))
km.out5<-kmeans(kmloan,5,nstart = 20)
km.out5
wss <- (nrow(kmloan))*sum(apply(kmloan,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(kmloan,centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares",
main="Assessing the Optimal Number of Clusters with the Elbow Method",
pch=20, cex=2)
#
km.out5$totss
kmloan$PROFITABLE<-loan$PROFITABLE
table(km.out5$cluster)
dist(km.out5$centers)
table(kmloan$PROFITABLE,km.out5$cluster)
cat("from the model it is difficult to see the clear label. There is profit and loss group in each cluster. and the center point is diffcult to interpert as in the scale dimension")
kmloan$NPV<-loan$NPV
kmloan$CLUSTER<-km.out5$cluster
#a.	Create a bar chart showing the percentage of people in each cluster.
qplot(kmloan$CLUSTER)+geom_bar(binwidth =0.3)
#b.	Create a table showing average of NPV split up by Cluster Id.
aggregate(kmloan$NPV, by=list(cluster=km.out5$cluster), mean)
#c.	Attach these as Exhibit 2.
km.out4<-kmeans(kmloan[,-41:-43],4,nstart = 20)
km.out4
aggregate(kmloan$NPV, by=list(cluster=km.out4$cluster), mean)
#
km.out6<-kmeans(kmloan[,-41:-43],6,nstart = 20)
km.out6
aggregate(kmloan$NPV, by=list(cluster=km.out6$cluster), mean)
asloan<-loan
asloan$HISTORY<-as.factor(asloan$HISTORY)
asloan$EMPLOYMENT<-as.factor(asloan$EMPLOYMENT)
asloan$OWN_RES<-as.factor(asloan$OWN_RES)
asloan$TYPE=NULL
asloan<-asloan[,sapply(asloan,is.factor)]
asloan$NPV<-loan$NPV
#
dummies<-dummyVars(NPV~.,data=asloan)
asloan1<-data.frame(predict(dummies,newdata = asloan))
asloan1<-data.frame(lapply(asloan1,factor))
#
asloan2<-loan
asloan2$AGE=NULL
asloan2$AMOUNT_REQUESTED=NULL
asloan2$NPV=NULL
asloan2<-data.frame(lapply(asloan2,factor))
rules<-apriori(asloan[,-8],parameter = list(supp=0.01,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules<-sort(rules,by="confidence",decreasing = TRUE)
rules2<-apriori(asloan2,parameter = list(supp=0.1,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules2<-sort(rules,by=c("confidence","lift"),decreasing = TRUE)
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph")
#
inspect(rules2[1:5])
summary(rules2)
plot(rules[1:5], method="graph")
cat("{CHK_ACCT=3,SAV_ACCT=3,HISTORY=4}    => {PROFITABLE=1}")
npv<-subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==3&loan$HISTORY==4)
sum(npv)
sum(subset(loan$NPV,loan$SAV_ACCT==3&loan$JOB==0))
cat("{CHK_ACCT=3,SAV_ACCT=3,HISTORY=4}    => {PROFITABLE=1}"\n)
cat("{CHK_ACCT=3,SAV_ACCT=3,HISTORY=4}    => {PROFITABLE=1} \n")
npv<-subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==3&loan$HISTORY==4)
cat("{CHK_ACCT=3,SAV_ACCT=3,HISTORY=4}    => {PROFITABLE=1} \n")
npv<-subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==3&loan$HISTORY==4)
sum(npv)
sum(subset(loan$NPV,loan$SAV_ACCT==3&loan$JOB==0))
cat("{CHK_ACCT=3,SAV_ACCT=3,HISTORY=4}    => {PROFITABLE=1} \n")
npv<-subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==3&loan$HISTORY==4)
sum(npv)
cat("{SAV_ACCT=3,HISTORY=4,OWN_RES=1}     => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$SAV_ACCT==3&loan$HISTORY==4$OWN_RES==1))
cat("{CHK_ACCT=3,SAV_ACCT=3,HISTORY=4}    => {PROFITABLE=1} \n")
npv<-subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==3&loan$HISTORY==4)
sum(npv)
cat("{SAV_ACCT=3,HISTORY=4,OWN_RES=1}     => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$SAV_ACCT==3&loan$HISTORY==4$loan$OWN_RES==1))
cat("{CHK_ACCT=3,SAV_ACCT=3,HISTORY=4}    => {PROFITABLE=1} \n")
npv<-subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==3&loan$HISTORY==4)
sum(npv)
cat("{SAV_ACCT=3,HISTORY=4,OWN_RES=1}     => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$SAV_ACCT==3&loan$HISTORY==4&loan$OWN_RES==1))
cat("{CHK_ACCT=3,SAV_ACCT=3,HISTORY=4}    => {PROFITABLE=1} \n")
npv<-subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==3&loan$HISTORY==4)
sum(npv)
cat("{SAV_ACCT=3,HISTORY=4,OWN_RES=1}     => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$SAV_ACCT==3&loan$HISTORY==4&loan$OWN_RES==1))
cat("{CHK_ACCT=2,EMPLOYMENT=4,JOB=2}      => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$CHK_ACCT==2&loan$EMPLOYMENT==4&loan$JOB==2))
cat("{CHK_ACCT=3,SAV_ACCT=4,EMPLOYMENT=3} => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==4&loan$EMPLOYMENT==3))
cat("{CHK_ACCT=3,EMPLOYMENT=3,JOB=1}      => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$CHK_ACCT==3&loan$EMPLOYMENT==3&loan$JOB==1))
cloan<-loan
cloan<-cloan[,c(2,3,8)]
cloan<-loan
cloan1<-cloan[,c(2,3,8)]
km.out<-kmeans(cloan1,5,nstart=20)
km.out$cluster
km.out
table(km.out$cluster,loan$PROFITABLE)
qplot(prop.table(kmloan$CLUSTER))+geom_bar(binwidth =0.3)
qplot(prop.table(kmloan$CLUSTER))+geom_bar()
barplot(prop.table(kmloan$CLUSTER))
prop.table(km.out5$cluster)
ggplot(kmloan, aes(x = factor(CLUSTER))) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels = percent)
ggplot(kmloan, aes(x = factor(CLUSTER))) +
geom_bar(aes(y = (..count..)/sum(..count..)))
kmloan$NPV<-loan$NPV
kmloan$CLUSTER<-km.out5$cluster
#a.	Create a bar chart showing the percentage of people in each cluster.
ggplot(kmloan, aes(x = factor(CLUSTER))) +
geom_bar(aes(y = (..count..)/sum(..count..)))
#b.	Create a table showing average of NPV split up by Cluster Id.
aggregate(kmloan$NPV, by=list(cluster=km.out5$cluster), mean)
#c.	Attach these as Exhibit 2.
aggregate(loan$NPV, by=list(cluster=km.out5$cluster), mean)
aggregate(loan$NPV, by=list(cluster=km.out$cluster), mean)
plotcluster(cloan,km.out)
cloan<-loan
cloan1<-cloan[,c(2,3,8)]
cloan1$EMPLOYMENT<-as.factor(cloan1$EMPLOYMENT)
km.out<-kmeans(cloan1,5,nstart=20)
km.out
table(km.out$cluster,loan$PROFITABLE)
aggregate(loan$NPV, by=list(cluster=km.out$cluster), mean)
plotcluster(cloan1,km.out)
cloan<-loan
cloan1<-cloan[,c(2,3,8)]
cloan1$EMPLOYMENT<-as.factor(cloan1$EMPLOYMENT)
km.out<-kmeans(cloan1,5,nstart=20)
table(km.out$cluster,loan$PROFITABLE)
aggregate(loan$NPV, by=list(cluster=km.out$cluster), mean)
plotcluster(cloan1,km.out)
plotcluster(cloan1,km.out$cluster)
cloan<-loan
cloan1<-cloan[,c(2,3,8)]
km.out<-kmeans(cloan1,5,nstart=20)
table(km.out$cluster,loan$PROFITABLE)
aggregate(loan$NPV, by=list(cluster=km.out$cluster), mean)
plotcluster(cloan1,km.out$cluster)
plot(cloan1,col=km.out$cluster)
cloan1<-cloan[,c(2,3,8)]
library(scatterplot3d)
scatterplot3d(cloan1$CHK_ACCT,cloan1$SAV_ACCT,cloan1$EMPLOYMENT, main="3D Scatterplot")
scatterplot3d(cloan1$CHK_ACCT,cloan1$SAV_ACCT,cloan1$EMPLOYMENT, main="3D Scatterplot", type=km.out$cluster)
scatterplot3d(cloan1$CHK_ACCT,cloan1$SAV_ACCT,cloan1$EMPLOYMENT, main="3D Scatterplot", col=km.out$cluster)
scatterplot3d(cloan1$CHK_ACCT,cloan1$SAV_ACCT,cloan1$EMPLOYMENT, main="3D Scatterplot", color=km.out$cluster)
scatterplot3d(cloan1$CHK_ACCT,cloan1$SAV_ACCT,cloan1$EMPLOYMENT, main="3D Scatterplot", type=1,color=km.out$cluster)
scatterplot3d(cloan1$CHK_ACCT,cloan1$SAV_ACCT,cloan1$EMPLOYMENT, main="3D Scatterplot", pch=km.out$cluster,color=km.out$cluster)
plotcluster(cloan1,km.out$cluster)
cloan<-loan
cloan1<-cloan[,c(2,3,8)]
km.out<-kmeans(cloan1,5,nstart=20)
table(km.out$cluster,loan$PROFITABLE)
aggregate(loan$NPV, by=list(cluster=km.out$cluster), mean)
km.out
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(ggplot2)
library(cluster)
library(fpc)
library(arules)
library(arulesViz)
#
loan<-read.csv("../HW6/data.csv",stringsAsFactors=FALSE)
loan$OBS.<-NULL
loan$CREDIT_EXTENDED<-NULL
loan$AMOUNT_REQUESTED<-gsub(pattern = ",",replacement = "",x = loan$AMOUNT_REQUESTED)
loan$NPV<-gsub(pattern = ",",replacement = "",x = loan$NPV)
loan$NPV<-as.numeric(loan$NPV)
loan$AMOUNT_REQUESTED<-as.numeric(loan$AMOUNT_REQUESTED)
#
loan$CHK_ACCT<-as.factor(loan$CHK_ACCT)
loan$SAV_ACCT<-as.factor(loan$SAV_ACCT)
loan$HISTORY<-as.factor(loan$HISTORY)
loan$JOB<-as.factor(loan$JOB)
loan$TYPE<-as.factor(loan$TYPE)
set.seed(12345)
#
kmloan<-loan
#
loan$PROFITABLE<-as.factor(ifelse(loan$NPV>0,1,0))
dummies<-dummyVars(NPV~.,data=kmloan)
kmloan<-data.frame(predict(dummies,newdata = kmloan))
kmloan=data.frame(scale(kmloan))
km.out5<-kmeans(kmloan,5,nstart = 20)
km.out5
wss <- (nrow(kmloan))*sum(apply(kmloan,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(kmloan,centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
ylab="Within groups sum of squares",
main="Assessing the Optimal Number of Clusters with the Elbow Method",
pch=20, cex=2)
#
km.out5$totss
kmloan$PROFITABLE<-loan$PROFITABLE
table(km.out5$cluster)
dist(km.out5$centers)
table(kmloan$PROFITABLE,km.out5$cluster)
cat("from the model it is difficult to see the clear label. There is profit and loss group in each cluster. and the center point is diffcult to interpert as in the scale dimension")
kmloan$NPV<-loan$NPV
kmloan$CLUSTER<-km.out5$cluster
#a.	Create a bar chart showing the percentage of people in each cluster.
ggplot(kmloan, aes(x = factor(CLUSTER))) +
geom_bar(aes(y = (..count..)/sum(..count..)))
#b.	Create a table showing average of NPV split up by Cluster Id.
aggregate(kmloan$NPV, by=list(cluster=km.out5$cluster), mean)
#c.	Attach these as Exhibit 2.
km.out4<-kmeans(kmloan[,-41:-43],4,nstart = 20)
km.out4
aggregate(kmloan$NPV, by=list(cluster=km.out4$cluster), mean)
#
km.out6<-kmeans(kmloan[,-41:-43],6,nstart = 20)
km.out6
aggregate(kmloan$NPV, by=list(cluster=km.out6$cluster), mean)
asloan<-loan
asloan$HISTORY<-as.factor(asloan$HISTORY)
asloan$EMPLOYMENT<-as.factor(asloan$EMPLOYMENT)
asloan$OWN_RES<-as.factor(asloan$OWN_RES)
asloan$TYPE=NULL
asloan<-asloan[,sapply(asloan,is.factor)]
asloan$NPV<-loan$NPV
#
dummies<-dummyVars(NPV~.,data=asloan)
asloan1<-data.frame(predict(dummies,newdata = asloan))
asloan1<-data.frame(lapply(asloan1,factor))
#
asloan2<-loan
asloan2$AGE=NULL
asloan2$AMOUNT_REQUESTED=NULL
asloan2$NPV=NULL
asloan2<-data.frame(lapply(asloan2,factor))
rules<-apriori(asloan[,-8],parameter = list(supp=0.01,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules<-sort(rules,by="confidence",decreasing = TRUE)
rules2<-apriori(asloan2,parameter = list(supp=0.1,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules2<-sort(rules,by=c("confidence","lift"),decreasing = TRUE)
inspect(rules[1:5])
summary(rules)
plot(rules[1:5], method="graph")
#
inspect(rules2[1:5])
summary(rules2)
plot(rules[1:5], method="graph")
cat("{CHK_ACCT=3,SAV_ACCT=3,HISTORY=4}    => {PROFITABLE=1} \n")
npv<-subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==3&loan$HISTORY==4)
sum(npv)
cat("{SAV_ACCT=3,HISTORY=4,OWN_RES=1}     => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$SAV_ACCT==3&loan$HISTORY==4&loan$OWN_RES==1))
cat("{CHK_ACCT=2,EMPLOYMENT=4,JOB=2}      => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$CHK_ACCT==2&loan$EMPLOYMENT==4&loan$JOB==2))
cat("{CHK_ACCT=3,SAV_ACCT=4,EMPLOYMENT=3} => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$CHK_ACCT==3&loan$SAV_ACCT==4&loan$EMPLOYMENT==3))
cat("{CHK_ACCT=3,EMPLOYMENT=3,JOB=1}      => {PROFITABLE=1} \n")
sum(subset(loan$NPV,loan$CHK_ACCT==3&loan$EMPLOYMENT==3&loan$JOB==1))
cloan<-loan
cloan1<-cloan[,c(2,3,8)]
km.out<-kmeans(cloan1,5,nstart=20)
table(km.out$cluster,loan$PROFITABLE)
aggregate(loan$NPV, by=list(cluster=km.out$cluster), mean)
km.out
cloan2<-asloan
cloan2$CLUSTER<-kmloan$CLUSTER
rules<-apriori(claon2[,-8],parameter = list(supp=0.01,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
cloan2<-asloan
cloan2$CLUSTER<-kmloan$CLUSTER
rules<-apriori(claon2[,-8],parameter = list(supp=0.01,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules<-apriori(cloan2[,-8],parameter = list(supp=0.01,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
cloan2$CLUSTER<-as.factor(kmloan$CLUSTER)
rules<-apriori(cloan2[,-8],parameter = list(supp=0.01,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules<-sort(rules,by="confidence",decreasing = TRUE)
#based on best association rule to reduce dimension of the kmeans.
cloan<-loan
cloan1<-cloan[,c(2,3,8)]
km.out<-kmeans(cloan1,5,nstart=20)
table(km.out$cluster,loan$PROFITABLE)
aggregate(loan$NPV, by=list(cluster=km.out$cluster), mean)
km.out
#based on the cluster k=5 kmeans to create association rule.
cloan2<-asloan
cloan2$CLUSTER<-as.factor(kmloan$CLUSTER)
rules3<-apriori(cloan2[,-8],parameter = list(supp=0.01,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules3<-sort(rules,by="confidence",decreasing = TRUE)
inspect(rules3)
#based on best association rule to reduce dimension of the kmeans.
cloan<-loan
cloan1<-cloan[,c(2,3,8)]
km.out<-kmeans(cloan1,5,nstart=20)
table(km.out$cluster,loan$PROFITABLE)
aggregate(loan$NPV, by=list(cluster=km.out$cluster), mean)
km.out
#based on the cluster k=5 kmeans to create association rule.
cloan2<-asloan
cloan2$CLUSTER<-as.factor(kmloan$CLUSTER)
rules3<-apriori(cloan2[,-8],parameter = list(supp=0.01,conf=0.8),
appearance = list(rhs=c('PROFITABLE=1'),default='lhs'),
control = list(verbose=F))
rules3<-sort(rules,by="confidence",decreasing = TRUE)
inspect(rules3[1:5])
pwd
dir
print(dir())
setwd(dir = "c:/Users/willi/Desktop/GitHub/DMproject/")
company=read.csv("crunshbase.csv")
download.file(url="https://raw.githubusercontent.com/233hehe/DMproject/master/crunchbase.csv",
destfile = "c.csv")
company<-read.csv("c.csv")
company<-read.csv("c.csv",stringAsFactor=FALSE)
company<-read.csv("c.csv",stringsAsFactors = FALSE)
company<-read.csv("c.csv",stringsAsFactors = FALSE,na.strings=c("NA","NaN", " "))
company$Company.Name
View(company)
company1<-company
company1$Company.Name.URL=NULL
company1$Category.Groups
company1$Categories
identical(company1$Categories,company1$Category.Groups)
gsub(pattern = ",",replacement = "",x=company1)
company1$Company.Name.URL=NULL
company2[,1:4]=company1[,1:4]
compan2=company1
company2=company1
company2[,1:4]=company1[,1:4]
company2$X=NULL
names(company2)
View(company1)
View(company2)
company3=company2[!is.na(company2$Category.Groups),]
company2$Category.Groups=gsub(pattern=" ",replacement = NA,x=company2$Category.Groups)
View(company2)
View(company2)
company2[,5:31]=gsub(pattern = ",",replacement = "",x=company1[,5:31])
company2$X=NULL
company2=company1
company2[,1:4]=company1[,1:4]
company2[,5:31]=gsub(pattern = ",",replacement = "",x=company1[,5:31])
company2$X=NULL
company2$Category.Groups=gsub(pattern="",replacement = NA,x=company2$Category.Groups)
company=read.csv("c.csv",stringsAsFactors = FALSE,na.strings=c("NA","NaN"))
View(company)
is.na(company)
apply(company,2,is.na)
apply(company,2,sum(is.na))
sum(is.na(company))
sum(is.na(company$Category.Groups))
company=read.csv("c.csv",stringsAsFactors = FALSE,na.strings=c("NA","NaN"))
company1=company
company1$Company.Name.URL=NULL
View(company)
rm(compan2)
company2$Category.Groups=gsub(pattern="",replacement = NA,x=company2$Category.Groups)
company1=company
company1$Company.Name.URL=NULL
company2=company1
company2[,1:4]=company1[,1:4]
company2[,5:31]=gsub(pattern = ",",replacement = "",x=company1[,5:31])
company2=company1
company2[,1:4]=company1[,1:4]
company2[,5:31]=gsub(pattern = ",",replacement = "",x=company1[,5:31])
View(company2)
company2[,1:4]=company1[,1:4]
company2=company1
company2[,1:4]=company1[,1:4]
